<<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EPIROC DS-FLEET PARAMETER ENTRY FORM</title>
    <style>
        body { font-family: 'Segoe UI', Arial, sans-serif; background-color: #f0f2f5; padding: 20px; margin: 0; }
        .header-section { max-width: 700px; margin: 0 auto 10px auto; text-align: center; }
        .brand-logo { max-width: 160px; height: auto; margin-bottom: 10px; }
        h2 { margin: 0; font-size: 22px; color: #333; border-bottom: 2px solid #FFD700; padding-bottom: 10px; }
        .sheet-container { background: white; border: 1px solid #ccc; box-shadow: 0 2px 10px rgba(0,0,0,0.1); max-width: 700px; margin: 0 auto; border-radius: 8px; overflow: hidden; }
        table { border-collapse: collapse; width: 100%; }
        td { border: 1px solid #dfe3e8; padding: 12px; font-size: 14px; }
        .hidden { display: none !important; }
        .status-tag { padding: 4px 8px; border-radius: 12px; font-size: 12px; font-weight: bold; margin-left: 10px; }
        .locked { background: #f8d7da; color: #721c24; }
        .unlocked { background: #d4edda; color: #155724; }
        tr:nth-child(odd) .label-cell { background-color: #FFD700 !important; color: #000; font-weight: bold; width: 45%; }
        tr:nth-child(even) .label-cell { background-color: #555555 !important; color: #ffffff; font-weight: bold; width: 45%; }
        input, select { width: 100%; padding: 8px; border: 1px solid #ced4da; border-radius: 4px; box-sizing: border-box; }
        .unlock-area { background: #fff3cd; padding: 15px; text-align: center; border-bottom: 2px solid #ffeeba; }
        button { padding: 10px 20px; border: none; border-radius: 4px; cursor: pointer; font-weight: bold; }
        .btn-unlock { background-color: #555; color: white; margin-left: 10px; }
        .btn-submit { background-color: #28a745; color: white; width: 100%; padding: 15px; font-size: 18px; }
        .sync-status { font-size: 11px; color: #28a745; font-weight: bold; display: none; padding: 5px; }
        .required-star { color: #dc3545; }
    </style>
</head>
<body>

    <div class="header-section">
        <img src="Picture1.png" alt="Epiroc Logo" class="brand-logo" onerror="this.style.display='none'">
        <h2>EPIROC DS-FLEET PARAMETER ENTRY FORM</h2>
    </div>

   <div class="sheet-container">
        <div class="unlock-area" id="lockZone">
            <input type="password" id="passInput" placeholder="Enter Unlock Password" style="width: 200px;">
            <button type="button" class="btn-unlock" onclick="validateLock()">Unlock Form</button>
        </div>
        
        <div style="text-align:center; padding: 10px 0;">
            <span id="statusLabel" class="status-tag locked">Locked</span>
        </div>

        <form id="residencyForm" class="hidden">
    <input type="hidden" name="Fleet Source" value="DS Fleet (Form B)">
    <table>
        <tr>
            <td class="label-cell">Customer Name <span class="required-star">*</span></td>
            <td>
                <select id="customerSelect" name="Customer Name" onchange="updateSites();" required>
                    <option value="">-- Select Customer --</option>
                    <option value="TATA STEEL LTD">TATA STEEL LTD</option>
                    <option value="NORTHERN COALFIELDS LTD">NORTHERN COALFIELDS LTD</option>
                    <option value="WESTERN COALFIELDS LTD">WESTERN COALFIELDS LTD</option>
                    <option value="EASTERN COALFIELDS LTD">EASTERN COALFIELDS LTD</option>
                    <option value="MAHANADI COALFIELDS LTD">MAHANADI COALFIELDS LTD</option>
                    <option value="THE SINGARENI COLLIERIES COMPANY LIMITED">THE SINGARENI COLLIERIES COMPANY LIMITED</option>
                    <option value="NMDC LTD">NMDC LTD</option>
                    <option value="SOUTH EASTERN COALFILEDS LTD">SOUTH EASTERN COALFILEDS LTD</option>
                    <option value="STEEL AUTHORITY OF INDIA LTD">STEEL AUTHORITY OF INDIA LTD</option>
                    <option value="BHARAT COKING COAL LIMITED">BHARAT COKING COAL LIMITED</option>
                    <option value="RELIANCE POWER">RELIANCE POWER</option>
                    <option value="JAIPRAKASH ASSOCIATES LTD">JAIPRAKASH ASSOCIATES LTD</option>
                    <option value="CENTRAL COALFIELDS LTD">CENTRAL COALFIELDS LTD</option>
                </select>
            </td>
        </tr>
        <tr>
            <td class="label-cell">Date <span class="required-star">*</span></td>
            <td><input type="date" name="Date" id="valDate" required></td>
        </tr>
        <tr>
            <td class="label-cell">Technician Name <span class="required-star">*</span></td>
            <td><input type="text" name="Technician Name" id="valTech" required></td>
        </tr>
        <tr>
            <td class="label-cell">Work Site <span class="required-star">*</span></td>
            <td>
                <select id="workSiteSelect" name="Work Site" onchange="updateFleet();" required>
                    <option value="">-- Select Site --</option>
                </select>
            </td>
        </tr>
        <tr>
            <td class="label-cell">Fleet ID <span class="required-star">*</span></td>
            <td>
                <select id="fleetSelect" name="Fleet ID" required>
                    <option value="">-- Select Fleet --</option>
                </select>
            </td>
        </tr>
        <tr>
            <td class="label-cell">Data Sync</td>
            <td>
                <button type="button" onclick="fetchPreviousData()" style="background:#007bff; color:white; width:100%; border:none; padding:8px; border-radius:4px;">
                    Fetch Last Entry for this Machine
                </button>
                <div id="syncStatus" class="sync-status" style="margin-top:5px; display:block;"></div>
            </td>
        </tr>
                <tr><td class="label-cell">Shift <span class="required-star">*</span></td><td><select name="Shift" required><option value="">-- Select Shift --</option><option>Shift A</option><option>Shift B</option><option>Shift C</option><option>G Shift</option></select></td></tr>
                
                <tr><td class="label-cell">Rotation Pressure</td><td><input type="number" step="any" name="Rotation Pressure" class="param-input"></td></tr>                    
<tr><td class="label-cell">Receiver Pr NoLoad (DTH & DS)</td><td><input type="number" step="any" name="Receiver Pr NoLoad (DTH & DS)" class="param-input"></td></tr>
<tr><td class="label-cell">Receiver Pr Unload (DTH & DS)</td><td><input type="number" step="any" name="Receiver Pr Unload (DTH & DS)" class="param-input"></td></tr>
<tr><td class="label-cell">Receiver Pr Load (DTH & DS)</td><td><input type="number" step="any" name="Receiver Pr Load (DTH & DS)" class="param-input"></td></tr>
<tr><td class="label-cell">Reduced Air pressure (DTH)</td><td><input type="number" step="any" name="Reduced Air pressure (DTH)" class="param-input"></td></tr>
<tr><td class="label-cell">Full Air Set Pr (DTH)</td><td><input type="number" step="any" name="Full Air Set Pr (DTH)" class="param-input"></td></tr>                    
<tr><td class="label-cell">Air Pressure Full</td><td><input type="number" step="any" name="Air Pressure Full" class="param-input"></td></tr>
<tr><td class="label-cell">Interstage Pr Load (DTH)</td><td><input type="number" step="any" name="Interstage Pr Load (DTH)" class="param-input"></td></tr>                    
<tr><td class="label-cell">Feed Pr High Impact</td><td><input type="number" step="any" name="Feed Pr High Impact" class="param-input"></td></tr>                    
<tr><td class="label-cell">Compressor Load (Smartroc & PV)</td><td><input type="number" step="any" name="Compressor Load (Smartroc & PV)" class="param-input"></td></tr>
<tr><td class="label-cell">Engine RPM Drilling</td><td><input type="number" step="any" name="Engine RPM Drilling" class="param-input"></td></tr>
<tr><td class="label-cell">Engine Temp <span class="required-star">*</span></td><td><input type="number" step="any" name="Engine Temp" id="valEngTemp" class="param-input" oninput="checkValidation()"></td></tr>
<tr><td class="label-cell">Hyd-Oil Temp</td><td><input type="number" step="any" name="Hyd-Oil Temp" class="param-input"></td></tr>
<tr><td class="label-cell">Ambient Temp</td><td><input type="number" step="any" name="Ambient Temp" class="param-input"></td></tr>
<tr><td class="label-cell">Engine load Drilling</td><td><input type="number" step="any" name="Engine load Drilling" class="param-input"></td></tr>
<tr><td class="label-cell">Boost Pressure</td><td><input type="number" step="any" name="Boost Pressure" class="param-input"></td></tr>
<tr><td class="label-cell">Engine oil pressure <span class="required-star">*</span></td><td><input type="number" step="any" name="Engine oil pressure" id="valEngOil" class="param-input" oninput="checkValidation()"></td></tr>
<tr><td class="label-cell">Air intake temp</td><td><input type="number" step="any" name="Air intake temp" class="param-input"></td></tr>
<tr><td class="label-cell">Compressor Temp (L & DS)</td><td><input type="number" step="any" name="Compressor Temp (L & DS)" class="param-input"></td></tr>
<tr><td class="label-cell">Compressor Temp (SRT40-T45& DTH) (H) (DTH)</td><td><input type="number" step="any" name="Compressor Temp (SRT40-T45& DTH) (H) (DTH)" class="param-input"></td></tr>
<tr><td class="label-cell">Charging Voltage</td><td><input type="number" step="any" name="Charging Voltage" class="param-input"></td></tr>
<tr><td class="label-cell">Fuel Pressure</td><td><input type="number" step="any" name="Fuel Pressure" class="param-input"></td></tr>
</table>
                <div style="padding: 20px;">
                <button type="submit" id="submitBtn" class="btn-submit">Submit Record</button>
            </div>
        </form>
    </div>
   <script>
   <script>
    /* 1. SCRAMBLED CONNECTION - URL & PASSWORD */
    var _0x5f22 = ["\x45\x70\x69\x72\x6f\x63\x40\x31\x32\x33", "\x68\x74\x74\x70\x73\x3a\x2f\x2f\x73\x63\x72\x69\x70\x74\x2e\x67\x6f\x6f\x67\x6c\x65\x2e\x63\x6f\x6d\x2f\x6d\x61\x63\x72\x6f\x73\x2f\x73\x2f\x41\x4b\x66\x79\x63\x62\x7a\x5f\x78\x77\x74\x6b\x76\x55\x76\x64\x30\x5a\x57\x44\x38\x7a\x50\x38\x6c\x57\x6b\x59\x57\x55\x55\x74\x30\x68\x33\x6c\x47\x6b\x6e\x4a\x57\x4d\x74\x69\x69\x49\x70\x4b\x49\x48\x59\x7a\x62\x6b\x35\x64\x39\x4d\x6e\x71\x79\x4f\x42\x56\x79\x63\x61\x55\x70\x36\x44\x48\x2f\x65\x78\x65\x63"];
    const passKey = _0x5f22[0];
    const scriptURL = _0x5f22[1];

    /* 2. UNLOCK FUNCTION */
    function validateLock() {
        const input = document.getElementById('passInput').value;
        const statusLabel = document.getElementById('statusLabel');
        if (input === passKey) {
            document.getElementById('residencyForm').classList.remove('hidden');
            document.getElementById('lockZone').style.display = 'none';
            statusLabel.innerText = "Unlocked";
            statusLabel.className = "status-tag unlocked";
        } else {
            alert("Incorrect Password");
        }
    }

    /* 3. MINIMAL DATA MAPPING (We will add your full list later) */
    const customerToSites = {
        "TATA STEEL LTD": ["Noamundi Iron Ore Mines", "Joda Iron Ore Mines"],
        "NORTHERN COALFIELDS LTD": ["Jayant Projects"]
    };

    const siteToFleet = {
        "Noamundi Iron Ore Mines": ["IDM45D-201608031"],
        "Jayant Projects": ["IDM30-202006955", "IDM30-202006951"]
    };

    /* 4. DROPDOWN UPDATE LOGIC */
    function updateSites() {
        const customer = document.getElementById('customerSelect').value;
        const siteSelect = document.getElementById('workSiteSelect');
        const fleetSelect = document.getElementById('fleetSelect');
        siteSelect.innerHTML = '<option value="">-- Select Site --</option>';
        fleetSelect.innerHTML = '<option value="">-- Select Fleet --</option>';
        if (customerToSites[customer]) {
            customerToSites[customer].forEach(s => {
                let opt = document.createElement('option');
                opt.value = opt.text = s;
                siteSelect.add(opt);
            });
        }
    }

    function updateFleet() {
        const site = document.getElementById('workSiteSelect').value;
        const fleetSelect = document.getElementById('fleetSelect');
        fleetSelect.innerHTML = '<option value="">-- Select Fleet --</option>';
        if (siteToFleet[site]) {
            siteToFleet[site].forEach(f => {
                let opt = document.createElement('option');
                opt.value = opt.text = f;
                fleetSelect.add(opt);
            });
        }
    }

    /* 5. SUBMISSION LOGIC */
    const form = document.getElementById('residencyForm');
    form.addEventListener('submit', e => {
        e.preventDefault();
        const btn = document.getElementById('submitBtn');
        btn.innerText = "Processing..."; btn.disabled = true;

        fetch(scriptURL, { method: 'POST', body: new FormData(form)})
        .then(response => {
            alert("Data Captured Successfully!");
            form.reset();
            btn.innerText = "Submit Record"; btn.disabled = false;
        })
        .catch(error => {
            alert("Submission Failed. Check GS deployment.");
            btn.innerText = "Submit Record"; btn.disabled = false;
        });
    });

    /* 6. FETCH LOGIC (Placeholder) */
    async function fetchPreviousData() {
        const fleet = document.getElementById('fleetSelect').value;
        const status = document.getElementById('syncStatus');
        if (!fleet) return;
        status.style.display = 'block';
        status.innerText = "‚è≥ Under Progress...";
    }
</script>
</body>
</html>






